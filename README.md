select `s`.`id` AS `id`,`s`.`full_name` AS `nombre_completo`,`s`.`document` AS `dni`,`s`.`email` AS `email`,`s`.`phone` AS `telefono`,`unificada`.`tipo_registro` AS `tipo_registro`,`unificada`.`entidad` AS `entidad`,`unificada`.`monto` AS `monto_deuda`,`unificada`.`situacion` AS `situacion`,`unificada`.`dias_vencimiento` AS `dias_vencimiento`,`cc`.`bank` AS `banco_tc`,`cc`.`line` AS `linea_credito_aprobada`,`cc`.`used` AS `linea_credito_utilizada`,`s`.`created_at` AS `fecha_creacion`,`s`.`created_at` - interval `unificada`.`dias_vencimiento` day AS `fecha_suscripcion_real` from (((`demo`.`subscriptions` `s` join `demo`.`subscription_reports` `sr` on(`s`.`id` = `sr`.`subscription_id`)) join (select `demo`.`report_loans`.`subscription_report_id` AS `subscription_report_id`,'Prestamo' AS `tipo_registro`,`demo`.`report_loans`.`bank` AS `entidad`,`demo`.`report_loans`.`amount` AS `monto`,`demo`.`report_loans`.`status` AS `situacion`,`demo`.`report_loans`.`expiration_days` AS `dias_vencimiento` from `demo`.`report_loans` union all select `demo`.`report_other_debts`.`subscription_report_id` AS `subscription_report_id`,'Otras Deudas' AS `tipo_registro`,`demo`.`report_other_debts`.`entity` AS `entidad`,`demo`.`report_other_debts`.`amount` AS `monto`,'Vigente' AS `situacion`,`demo`.`report_other_debts`.`expiration_days` AS `dias_vencimiento` from `demo`.`report_other_debts`) `unificada` on(`sr`.`id` = `unificada`.`subscription_report_id`)) left join `demo`.`report_credit_cards` `cc` on(`sr`.`id` = `cc`.`subscription_report_id`)) order by `s`.`created_at` - interval `unificada`.`dias_vencimiento` day desc
